spring:
  application:
    name: jimi
  
  main:
    banner-mode: off
    log-startup-info: false
    web-application-type: none

logging:
  level:
    root: INFO
    io.leavesfly.jimi: DEBUG
  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss} - %msg%n"

# Jackson 配置
  jackson:
    serialization:
      indent_output: true
      write_dates_as_timestamps: false
    deserialization:
      fail_on_unknown_properties: false

# Jimi 配置
jimi:
  # Skills 功能配置
  skill:
    # 是否启用 Skills 功能
    enabled: false
    # 是否自动匹配 Skills
    auto-match: true
    # 匹配配置
    matching:
      # 用户输入匹配的最低得分阈值 (0-100)
      score-threshold: 30
      # 上下文匹配的最低得分阈值 (0-100)
      context-score-threshold: 15
      # 最大匹配 Skills 数量
      max-matched-skills: 5
      # 是否启用上下文动态匹配
      enable-context-matching: false
    # 缓存配置
    cache:
      # 是否启用缓存
      enabled: true
      # 缓存过期时间（秒）
      ttl: 3600
      # 缓存最大条目数
      max-size: 1000
    # 脚本执行配置
    script-execution:
      # 是否启用脚本执行
      enabled: true
      # 脚本执行超时时间（秒）
      timeout: 60
      # 是否需要审批
      require-approval: false
    # 日志配置
    logging:
      # 是否记录匹配详情
      log-match-details: false
      # 是否记录注入详情
      log-injection-details: false
      # 是否记录性能指标
      log-performance-metrics: false

  # 代码图功能配置
  graph:
    # 是否启用代码图功能
    enabled: true
    # 是否自动构建代码图（文件变化时）
    auto-build: false
    # 启动时是否构建代码图
    build-on-startup: false
    # 图存储路径
    storage-path: ".jimi/code_graph"
    # 启动时是否自动加载已保存的图
    auto-load: true
    # 构建后是否自动保存
    auto-save: true
    # 包含文件模式
    include-patterns:
      - "**/*.java"
    # 排除文件模式
    exclude-patterns:
      - "**/test/**"
      - "**/tests/**"
      - "**/target/**"
      - "**/build/**"
      - "**/node_modules/**"
      - "**/.git/**"
    # 缓存配置
    cache:
      enabled: true
      ttl: 3600
      max-size: 10000
    # 搜索配置
    search:
      max-results: 50
      enable-hybrid: true
      graph-weight: 0.6
      vector-weight: 0.4
      min-similarity: 0.3

  # 记忆模块配置 (ReCAP 优化)
  memory:
    # 有界提示最大 Token 数
    active-prompt-max-tokens: 4000
    # 关键发现窗口大小（最近 N 条进入提示）
    insights-window-size: 5
    # 是否启用 ReCAP 优化（默认关闭）
    enable-recap: false
    # 最大递归深度
    max-recursion-depth: 5

  # 编程式工具调用配置 (Programmatic Tool Calling)
  meta-tool:
    # 是否启用 MetaTool
    enabled: true
    # 最大执行时间（秒）
    max-execution-time: 30
    # 最大代码长度（字符）
    max-code-length: 10000
    # 是否记录执行详情
    log-execution-details: true
